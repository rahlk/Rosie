{"r.dependencies":{"text":"#MIT License\n#\n#Copyright (c) 2017 Todd Schneider\n#\n#Permission is hereby granted, free of charge, to any person obtaining a copy\n#of this software and associated documentation files (the \"Software\"), to deal\n#in the Software without restriction, including without limitation the rights\n#to use, copy, modify, merge, publish, distribute, sublicense, and\/or sell\n#copies of the Software, and to permit persons to whom the Software is\n#furnished to do so, subject to the following conditions:\n#\n#The above copyright notice and this permission notice shall be included in all\n#copies or substantial portions of the Software.\n#\n#THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n#IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n#FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n#AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n#LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n#OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n#SOFTWARE.\n\nboroughs = c(\"Manhattan\", \"Brooklyn\", \"Queens\", \"Bronx\", \"Staten Island\")\nyellow_hex = \"#f7b731\"\ngreen_hex = \"#3f9e4d\"\nuber_hex = \"#222222\"\n\nif (all(c(\"Open Sans\", \"PT Sans\") %in% fonts())) {\n  font_family = \"Open Sans\"\n  title_font_family = \"PT Sans\"\n} else {\n  font_family = \"Arial\"\n  title_font_family = \"Arial\"\n}\n\ncon = dbConnect(dbDriver(\"PostgreSQL\"), dbname = \"nyc-taxi-data\", host = \"localhost\")\nquery = function(sql) { fetch(dbSendQuery(con, sql), n = 1e8) }\n\nadd_credits = function(fontsize = 12, color = \"#777777\", xpos = 0.99) {\n  grid.text(\"toddwschneider.com\",\n            x = xpos,\n            y = 0.02,\n            just = \"right\",\n            gp = gpar(fontsize = fontsize, col = color, fontfamily = font_family))\n}\n\ntitle_with_subtitle = function(title, subtitle = \"\") {\n  ggtitle(bquote(atop(bold(.(title)), atop(.(subtitle)))))\n}\n\nto_slug = function(string) {\n  gsub(\"-\", \"_\", gsub(\" \", \"_\", tolower(string)))\n}\n\ntheme_tws = function(base_size = 12) {\n  bg_color = \"#f4f4f4\"\n  bg_rect = element_rect(fill = bg_color, color = bg_color)\n\n  theme_bw(base_size) +\n    theme(text = element_text(family = font_family),\n          plot.title = element_text(family = title_font_family),\n          plot.background = bg_rect,\n          panel.background = bg_rect,\n          legend.background = bg_rect,\n          panel.grid.major = element_line(colour = \"grey80\", size = 0.25),\n          panel.grid.minor = element_line(colour = \"grey80\", size = 0.25),\n          legend.key.width = unit(1.5, \"line\"),\n          legend.key = element_blank())\n}\n\ntheme_dark_map = function(base_size = 12) {\n  theme_bw(base_size) +\n    theme(text = element_text(family = font_family, color = \"#ffffff\"),\n          rect = element_rect(fill = \"#000000\", color = \"#000000\"),\n          plot.background = element_rect(fill = \"#000000\", color = \"#000000\"),\n          panel.background = element_rect(fill = \"#000000\", color = \"#000000\"),\n          plot.title = element_text(family = title_font_family),\n          panel.grid = element_blank(),\n          panel.border = element_blank(),\n          axis.text = element_blank(),\n          axis.title = element_blank(),\n          axis.ticks = element_blank())\n}\n\ntheme_tws_map = function(...) {\n  theme_tws(...) +\n    theme(panel.grid.major = element_blank(),\n          panel.grid.minor = element_blank(),\n          panel.border = element_blank(),\n          axis.text = element_blank(),\n          axis.title = element_blank(),\n          axis.ticks.length = unit(0, \"cm\"),\n          plot.margin = unit(c(1, 1, 1, 0.5), \"lines\"))\n}\n\nnta_display_name = function(ntacode) {\n  c(BK33 = \"Carroll Gardens-Red Hook\",\n    BK38 = \"DUMBO-Downtown-Boerum Hill\",\n    BK73 = \"Williamsburg\",\n    MN03 = \"Central Harlem North\",\n    MN13 = \"Chelsea-Flatiron-Union Square\",\n    MN17 = \"Midtown\",\n    MN24 = \"SoHo-TriBeCa-Little Italy\",\n    MN25 = \"Battery Park-Lower Manhattan\",\n    MN40 = \"Upper East Side\",\n    MN50 = \"Stuyvesant Town\",\n    QN31 = \"Hunters Point-Sunnyside\",\n    QN68 = \"Long Island City\")[ntacode]\n}\n","pos":1}}
