{"py.strings":{"text":"# coding: utf-8\n\nclass menuitem:\n    def __init__(self, parent, name, url, active = True, template = None):\n        self.name = name\n        self.url = url\n        self.parent = parent\n        self.active = active # this is an inline comment\n        self.full_url = self.compute_full_url()\n        if template == None:\n            self.template = parent.template + ('' if name == '' else '\/' + name)\n        elif template.startswith('\/'):\n            self.template = template[1:-1]\n        else:\n            self.template = parent.template + '\/' + template\n\n    def compute_full_url(self):\n        if self.url.startswith('http'):\n            return self.url\n        return self.parent.full_url + self.url\n\nclass dummymenuitem(menuitem):\n    def __init__(self):\n        menuitem.__init__(self, rootmenuitem(), name = 'none', url = '')\n\nclass rootmenuitem(menuitem):\n    def __init__(self):\n        menuitem.__init__(self, parent = None, name = '', url = '', active = False, template = '\/')\n\n    def compute_full_url(self):\n        return '\/'\n\nclass globalmenuitem(menuitem):\n    def __init__(self, name, url, icon, alt, active = True, template = None):\n        menuitem.__init__(self, parent = rootmenuitem(), name = name, url = url, active = active, template = template)\n        self.icon = icon\n        self.alt = alt\n\nclass contentmenuitem(menuitem):\n    def __init__(self, parent, name, url, text, visible = True, cols = 3, template = None):\n        menuitem.__init__(self, parent, name, url, template = template)\n        self.text = text\n        self.cols = cols\n        self.visible = visible\n\ndef find_active_item(path, items):\n    best_fit = None\n    for item in items:\n        if path == item.url.rstrip('\/') or path.startswith(item.url):\n            if best_fit is None or len(item.url) > len(best_fit.url):\n                best_fit = item\n    return best_fit or dummymenuitem()\n\ndef menu(path):\n    global_menu = [\n        # globalmenuitem(name = 'home',    url = '',  icon = 'icon-yoursway.png', template = 'index', alt = 'Home'),\n        # globalmenuitem(name = 'consulting', url = 'consulting\/', icon = 'icon-consulting.png',  alt = 'Consulting'),\n        globalmenuitem(name = 'consulting', url = '', icon = 'icon-yoursway.png',  alt = 'YourSway'),\n        # globalmenuitem(name = 'ide',     url = 'ide\/', active = False, icon = 'icon-ide.png',      alt = 'YourSway IDE'),\n        # globalmenuitem(name = 'taskus',  url = 'taskus\/',  icon = 'icon-taskus.png',   alt = 'Taskus'),\n        globalmenuitem(name = 'free', url = 'free\/', icon = 'icon-free.png',  alt = 'Free Tools'),\n        globalmenuitem(name = 'aboutus', url = 'aboutus\/', icon = 'icon-aboutus.png',  alt = 'About Us'),\n        globalmenuitem(name = 'blog', url = 'http:\/\/blog.yoursway.com\/', icon = 'icon-blog.png',  alt = 'Blog'),\n    ]\n\n    path = path.lstrip('\/')\n\n    active_global_item = find_active_item(path, global_menu)\n    path = path[len(active_global_item.url) : -1]\n\n    if active_global_item.name == 'taskus':\n        content_menu = [\n            contentmenuitem(parent = active_global_item, name = '', url = '', template = 'overview', text = \"5 easy rules\", cols = 4),\n            contentmenuitem(parent = active_global_item, name = 'screencast', url = 'screencast\/', text = 'Screencast', cols = 4),\n            contentmenuitem(parent = active_global_item, name = 'qa', url = 'qa\/', text = 'Productivity Q&A', cols = 6),\n            contentmenuitem(parent = active_global_item, name = 'support', url = 'support\/', text = 'Support', cols = 4),\n        ]\n    elif active_global_item.name == 'free':\n        content_menu = [\n        contentmenuitem(parent = active_global_item, name = '', url = '', template = 'overview', text = \"Overview\", cols = 4),\n        contentmenuitem(parent = active_global_item, name = 'ProjectSync', url = 'ProjectSync\/', text = 'ProjectSync', cols = 4),\n        # contentmenuitem(parent = active_global_item, name = 'ide-features', url = 'ide\/features', text = '', visible = False),\n        # contentmenuitem(parent = active_global_item, name = 'mashups', url = 'mashups\/', text = 'Desktop & Web app', cols = 7),\n        # contentmenuitem(parent = active_global_item, name = 'iphone', url = 'iphone\/', text = 'iPhone app', cols = 4),\n        ]\n    elif active_global_item.name == 'consulting':\n        content_menu = [\n        contentmenuitem(parent = active_global_item, name = '', url = '', template = 'overview', text = \"Overview\", cols = 4),\n        contentmenuitem(parent = active_global_item, name = 'ide', url = 'ide\/', text = 'I want an IDE', cols = 5),\n        contentmenuitem(parent = active_global_item, name = 'ide-features', url = 'ide\/features', text = '', visible = False),\n        contentmenuitem(parent = active_global_item, name = 'mashups', url = 'mashups\/', text = 'Desktop & Web app', cols = 7),\n        contentmenuitem(parent = active_global_item, name = 'iphone', url = 'iphone\/', text = 'iPhone app', cols = 4),        ]\n    else:\n        content_menu = []\n\n    remaining_content_menu_cols = 23 - sum([item.cols for item in content_menu if item.visible])\n\n    active_content_item = find_active_item(path, content_menu)\n    if isinstance(active_content_item, dummymenuitem):\n        active_item = active_global_item\n    else:\n        active_item = active_content_item\n\n    visible_content_menu_items = [item for item in content_menu if item.visible]\n\n    return (active_item, dict(global_menu = global_menu,\n        content_menu = visible_content_menu_items,\n        active_global_item = active_global_item.name,\n        active_content_item = active_content_item.name,\n        remaining_content_menu_cols = remaining_content_menu_cols,\n    ))\n","subs":[{"py.string":{"text":"''","pos":367}},{"py.string":{"text":"''","pos":381}},{"py.string":{"text":"'\/'","pos":389}},{"py.string":{"text":"'\/'","pos":434}},{"py.string":{"text":"'\/'","pos":543}},{"py.string":{"text":"'http'","pos":622}},{"py.string":{"text":"'none'","pos":817}},{"py.string":{"text":"''","pos":831}},{"py.string":{"text":"''","pos":944}},{"py.string":{"text":"''","pos":954}},{"py.string":{"text":"'\/'","pos":985}},{"py.string":{"text":"'\/'","pos":1038}},{"py.string":{"text":"'\/'","pos":1713}},{"py.string":{"text":"'consulting'","pos":2192}},{"py.string":{"text":"''","pos":2212}},{"py.string":{"text":"'icon-yoursway.png'","pos":2223}},{"py.string":{"text":"'YourSway'","pos":2251}},{"py.string":{"text":"'free'","pos":2524}},{"py.string":{"text":"'free\/'","pos":2538}},{"py.string":{"text":"'icon-free.png'","pos":2554}},{"py.string":{"text":"'Free Tools'","pos":2578}},{"py.string":{"text":"'aboutus'","pos":2623}},{"py.string":{"text":"'aboutus\/'","pos":2640}},{"py.string":{"text":"'icon-aboutus.png'","pos":2659}},{"py.string":{"text":"'About Us'","pos":2686}},{"py.string":{"text":"'blog'","pos":2729}},{"py.string":{"text":"'http:\/\/blog.yoursway.com\/'","pos":2743}},{"py.string":{"text":"'icon-blog.png'","pos":2779}},{"py.string":{"text":"'Blog'","pos":2803}},{"py.string":{"text":"'\/'","pos":2842}},{"py.string":{"text":"'taskus'","pos":2994}},{"py.string":{"text":"''","pos":3093}},{"py.string":{"text":"''","pos":3103}},{"py.string":{"text":"'overview'","pos":3118}},{"py.string":{"text":"\"5 easy rules\"","pos":3137}},{"py.string":{"text":"'screencast'","pos":3228}},{"py.string":{"text":"'screencast\/'","pos":3248}},{"py.string":{"text":"'Screencast'","pos":3270}},{"py.string":{"text":"'qa'","pos":3359}},{"py.string":{"text":"'qa\/'","pos":3371}},{"py.string":{"text":"'Productivity Q&A'","pos":3385}},{"py.string":{"text":"'support'","pos":3480}},{"py.string":{"text":"'support\/'","pos":3497}},{"py.string":{"text":"'Support'","pos":3516}},{"py.string":{"text":"'free'","pos":3584}},{"py.string":{"text":"''","pos":3677}},{"py.string":{"text":"''","pos":3687}},{"py.string":{"text":"'overview'","pos":3702}},{"py.string":{"text":"\"Overview\"","pos":3721}},{"py.string":{"text":"'ProjectSync'","pos":3804}},{"py.string":{"text":"'ProjectSync\/'","pos":3825}},{"py.string":{"text":"'ProjectSync'","pos":3848}},{"py.string":{"text":"'consulting'","pos":4300}},{"py.string":{"text":"''","pos":4399}},{"py.string":{"text":"''","pos":4409}},{"py.string":{"text":"'overview'","pos":4424}},{"py.string":{"text":"\"Overview\"","pos":4443}},{"py.string":{"text":"'ide'","pos":4526}},{"py.string":{"text":"'ide\/'","pos":4539}},{"py.string":{"text":"'I want an IDE'","pos":4554}},{"py.string":{"text":"'ide-features'","pos":4642}},{"py.string":{"text":"'ide\/features'","pos":4664}},{"py.string":{"text":"''","pos":4687}},{"py.string":{"text":"'mashups'","pos":4769}},{"py.string":{"text":"'mashups\/'","pos":4786}},{"py.string":{"text":"'Desktop & Web app'","pos":4805}},{"py.string":{"text":"'iphone'","pos":4897}},{"py.string":{"text":"'iphone\/'","pos":4913}},{"py.string":{"text":"'iPhone app'","pos":4931}}],"pos":1}}
