{"cpp.strings":{"text":"#include \"CPU.h\"\nusing namespace FAES;\n\nbool CPU::cpuidSupported() {\n  \/\/ This method uses the ID flag in bit 21 of the EFLAGS register. If\n  \/\/ software can change the value of this flag, the CPUID instruction\n  \/\/ is executable.\n  unsigned int res;\n  __asm__ (\"mov %%ecx, %%eax;\"\n           \"xor $200000, %%eax;\"\n           \"xor %%ecx, %%eax;\"\n           \"je no;\"\n           \"mov $1, %%eax;\"\n           \"jmp end;\"\n           \"no: mov $0, %%eax;\"\n           \"end:;\"\n           : \"=a\" (res)\n           :\n           : \"cc\"); \n  \n  return res > 0;\n}\n\nvoid CPU::cpuid(unsigned int opcode, unsigned int result[4]) {\n  if (!cpuidSupported()) return;\n\n  \/\/ PIC compliant version\n  __asm__ (\"cpuid;\"\n           \"movl %%ebx, %1;\" \n           : \"=a\" (result[0]), \/\/ EAX register -> result[0]\n             \"=r\" (result[1]), \/\/ EBX register -> result[1]\n             \"=c\" (result[2]), \/\/ ECX register -> result[2]\n             \"=d\" (result[3])  \/\/ EDX register -> result[3]\n           : \"0\" (opcode)\n           : \"cc\");\n}\n\nbool CPU::sse41Supported() {\n  CPUFeatures2_t features;\n  unsigned int res[4];\n  cpuid(1, res);\n  features.raw_data = res[3];\n  return features.features.SSE4_1 == 1;  \n}\n\nbool CPU::aesSupported() {\n  CPUFeatures2_t features;\n  unsigned int res[4];\n  cpuid(1, res);\n  features.raw_data = res[3];\n  return features.features.AES == 1;\n}\n","subs":[{"cpp.string":{"text":"\"CPU.h\"","pos":10}},{"cpp.string":{"text":"\"mov %%ecx, %%eax;\"","pos":263}},{"cpp.string":{"text":"\"xor $200000, %%eax;\"","pos":294}},{"cpp.string":{"text":"\"xor %%ecx, %%eax;\"","pos":327}},{"cpp.string":{"text":"\"je no;\"","pos":358}},{"cpp.string":{"text":"\"mov $1, %%eax;\"","pos":378}},{"cpp.string":{"text":"\"jmp end;\"","pos":406}},{"cpp.string":{"text":"\"no: mov $0, %%eax;\"","pos":428}},{"cpp.string":{"text":"\"end:;\"","pos":460}},{"cpp.string":{"text":"\"=a\"","pos":481}},{"cpp.string":{"text":"\"cc\"","pos":518}},{"cpp.string":{"text":"\"cpuid;\"","pos":685}},{"cpp.string":{"text":"\"movl %%ebx, %1;\"","pos":705}},{"cpp.string":{"text":"\"0\"","pos":977}},{"cpp.string":{"text":"\"cc\"","pos":1003}}],"pos":1}}
