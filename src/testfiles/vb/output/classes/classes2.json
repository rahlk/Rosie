{"vb.classes":{"text":"Imports System.IO\nImports System.Text.RegularExpressions\n\nPublic Class skinList\n    Public skinsDirectory As New ArrayList\n    Public skinsLabel As New ArrayList\n    Public count As Int16 = 0\n    Public Sub New(path As String)\n        Dim dirInfo = New DirectoryInfo(path + \"\\skins\").GetDirectories\n        Dim skinPathRgx = New Regex(\"Metro For Steam\", RegexOptions.IgnoreCase)\n        Dim versionRgx = New Regex(\"[0-9]\\.[0-9](\\.[0-9]|)\")\n        For Each folder In dirInfo\n            Dim temppath = folder.Name.ToString()\n\n            Dim menufile = path + \"\\skins\\\" + temppath + \"\\resource\\menus\\steam.menu\"\n\n            If File.Exists(menufile) Then\n                Dim menufileb = New readFile(menufile)\n                Dim menufile_contents = menufileb.contents\n                If skinPathRgx.IsMatch(menufile_contents) Then\n                    Dim version_match = versionRgx.Match(menufile_contents)\n                    If versionRgx.IsMatch(menufile_contents) Then\n                        skinsDirectory.Add(temppath)\n                        skinsLabel.Add(temppath + \" [\" + version_match.ToString + \"]\")\n                        count += 1\n                    End If\n                End If\n            End If\n        Next\n    End Sub\nEnd Class","subs":[{"vb.class":{"text":"Public Class skinList\n    Public skinsDirectory As New ArrayList\n    Public skinsLabel As New ArrayList\n    Public count As Int16 = 0\n    Public Sub New(path As String)\n        Dim dirInfo = New DirectoryInfo(path + \"\\skins\").GetDirectories\n        Dim skinPathRgx = New Regex(\"Metro For Steam\", RegexOptions.IgnoreCase)\n        Dim versionRgx = New Regex(\"[0-9]\\.[0-9](\\.[0-9]|)\")\n        For Each folder In dirInfo\n            Dim temppath = folder.Name.ToString()\n\n            Dim menufile = path + \"\\skins\\\" + temppath + \"\\resource\\menus\\steam.menu\"\n\n            If File.Exists(menufile) Then\n                Dim menufileb = New readFile(menufile)\n                Dim menufile_contents = menufileb.contents\n                If skinPathRgx.IsMatch(menufile_contents) Then\n                    Dim version_match = versionRgx.Match(menufile_contents)\n                    If versionRgx.IsMatch(menufile_contents) Then\n                        skinsDirectory.Add(temppath)\n                        skinsLabel.Add(temppath + \" [\" + version_match.ToString + \"]\")\n                        count += 1\n                    End If\n                End If\n            End If\n        Next\n    End Sub\nEnd Class","subs":[{"vb.classdef":{"text":"Public Class skinList\n    ","subs":[{"vb.classname":{"text":"skinList","pos":72}}],"pos":59}},{"vb.classbody":{"text":"Public skinsDirectory As New ArrayList\n    Public skinsLabel As New ArrayList\n    Public count As Int16 = 0\n    Public Sub New(path As String)\n        Dim dirInfo = New DirectoryInfo(path + \"\\skins\").GetDirectories\n        Dim skinPathRgx = New Regex(\"Metro For Steam\", RegexOptions.IgnoreCase)\n        Dim versionRgx = New Regex(\"[0-9]\\.[0-9](\\.[0-9]|)\")\n        For Each folder In dirInfo\n            Dim temppath = folder.Name.ToString()\n\n            Dim menufile = path + \"\\skins\\\" + temppath + \"\\resource\\menus\\steam.menu\"\n\n            If File.Exists(menufile) Then\n                Dim menufileb = New readFile(menufile)\n                Dim menufile_contents = menufileb.contents\n                If skinPathRgx.IsMatch(menufile_contents) Then\n                    Dim version_match = versionRgx.Match(menufile_contents)\n                    If versionRgx.IsMatch(menufile_contents) Then\n                        skinsDirectory.Add(temppath)\n                        skinsLabel.Add(temppath + \" [\" + version_match.ToString + \"]\")\n                        count += 1\n                    End If\n                End If\n            End If\n        Next\n    End Sub\n","pos":85}},{"vb.classend":{"text":"End Class","pos":1244}}],"pos":59}}],"pos":1}}
