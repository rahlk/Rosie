{"vb.dependencies":{"pos":1,"subs":[{"vb.dependency":{"pos":1,"subs":[{"vb.dependency_name":{"pos":9,"text":"System.IO"}}],"text":"Imports System.IO"}},{"vb.dependency":{"pos":19,"subs":[{"vb.dependency_name":{"pos":27,"text":"System.Text.RegularExpressions"}}],"text":"Imports System.Text.RegularExpressions"}}],"text":"Imports System.IO\nImports System.Text.RegularExpressions\n\nPublic Class skinList\n    Public skinsDirectory As New ArrayList\n    Public skinsLabel As New ArrayList\n    Public count As Int16 = 0\n    Public Sub New(path As String)\n        Dim dirInfo = New DirectoryInfo(path + \"\\skins\").GetDirectories\n        Dim skinPathRgx = New Regex(\"Metro For Steam\", RegexOptions.IgnoreCase)\n        Dim versionRgx = New Regex(\"[0-9]\\.[0-9](\\.[0-9]|)\")\n        For Each folder In dirInfo\n            Dim temppath = folder.Name.ToString()\n\n            Dim menufile = path + \"\\skins\\\" + temppath + \"\\resource\\menus\\steam.menu\"\n\n            If File.Exists(menufile) Then\n                Dim menufileb = New readFile(menufile)\n                Dim menufile_contents = menufileb.contents\n                If skinPathRgx.IsMatch(menufile_contents) Then\n                    Dim version_match = versionRgx.Match(menufile_contents)\n                    If versionRgx.IsMatch(menufile_contents) Then\n                        skinsDirectory.Add(temppath)\n                        skinsLabel.Add(temppath + \" [\" + version_match.ToString + \"]\")\n                        count += 1\n                    End If\n                End If\n            End If\n        Next\n    End Sub\n"}}
