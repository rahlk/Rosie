{"vb.functions":{"subs":[{"vb.function":{"subs":[{"vb.funcdef":{"subs":[{"vb.funcname":{"text":"checkPreciseFileName","pos":548}}],"text":"Sub checkPreciseFileName()\n\n    ","pos":544}},{"vb.funcbody":{"text":"printMsg \"[*] Checking Precise Filename ...\"\n    \n    badName = False\n\n  \n    If ActiveDocument.Name <> \"Pafish.docm\" Then\n            badName = True\n    End If\n \n    If badName Then\n        \n        printMsg \"DETECTED\"\n    Else\n        \n        printMsg \"OK\"\n    End If\n    \n","pos":576}}],"text":"Sub checkPreciseFileName()\n\n    printMsg \"[*] Checking Precise Filename ...\"\n    \n    badName = False\n\n  \n    If ActiveDocument.Name <> \"Pafish.docm\" Then\n            badName = True\n    End If\n \n    If badName Then\n        \n        printMsg \"DETECTED\"\n    Else\n        \n        printMsg \"OK\"\n    End If\n    \nEnd Sub","pos":544}},{"vb.function":{"subs":[{"vb.funcdef":{"subs":[{"vb.funcname":{"text":"checkFilenameHash","pos":872}}],"text":"Sub checkFilenameHash()\n\n    ","pos":868}},{"vb.funcbody":{"text":"printMsg \"[*] Checking Filename Hashname ...\"\n    \n    hexchars = \"0123456789abcdef\"\n    \n    c = 0\n    \n    For i = 1 To Len(ThisDocument.Name)\n        s = Mid(LCase(ThisDocument.Name), i, 1)\n        \n        If InStr(s, hexchars) > 0 Then\n            c = c + 1\n        End If\n        \n    Next\n    \n    If c >= (Len(ThisDocument.Name) - 5) Then\n        printMsg \"DETECTED\"\n        \n    Else\n    \n    \n        printMsg \"OK\"\n    End If\n    \n","pos":897}}],"text":"Sub checkFilenameHash()\n\n    printMsg \"[*] Checking Filename Hashname ...\"\n    \n    hexchars = \"0123456789abcdef\"\n    \n    c = 0\n    \n    For i = 1 To Len(ThisDocument.Name)\n        s = Mid(LCase(ThisDocument.Name), i, 1)\n        \n        If InStr(s, hexchars) > 0 Then\n            c = c + 1\n        End If\n        \n    Next\n    \n    If c >= (Len(ThisDocument.Name) - 5) Then\n        printMsg \"DETECTED\"\n        \n    Else\n    \n    \n        printMsg \"OK\"\n    End If\n    \nEnd Sub","pos":868}},{"vb.function":{"subs":[{"vb.funcdef":{"subs":[{"vb.funcname":{"text":"checkFilenameBad","pos":1358}}],"text":"Sub checkFilenameBad()\n\n    ","pos":1354}},{"vb.funcbody":{"text":"printMsg \"[*] Checking Bad Filename ...\"\n    \n    badName = False\n    badNames = Array(\"malware\", \"myapp\", \"sample\", \".bin\", \"mlwr_\", \"Desktop\")\n\n    \n    For Each n In badNames\n        If InStr(LCase(ActiveDocument.FullName), n) > 0 Then\n            badName = True\n        End If\n    Next\n \n\n    If badName Then\n        \n        printMsg \"DETECTED\"\n    Else\n        \n        printMsg \"OK\"\n    End If\n    \n","pos":1382}}],"text":"Sub checkFilenameBad()\n\n    printMsg \"[*] Checking Bad Filename ...\"\n    \n    badName = False\n    badNames = Array(\"malware\", \"myapp\", \"sample\", \".bin\", \"mlwr_\", \"Desktop\")\n\n    \n    For Each n In badNames\n        If InStr(LCase(ActiveDocument.FullName), n) > 0 Then\n            badName = True\n        End If\n    Next\n \n\n    If badName Then\n        \n        printMsg \"DETECTED\"\n    Else\n        \n        printMsg \"OK\"\n    End If\n    \nEnd Sub","pos":1354}},{"vb.function":{"subs":[{"vb.funcdef":{"subs":[{"vb.funcname":{"text":"checkTasks","pos":1808}}],"text":"Sub checkTasks()\n\n    ","pos":1804}},{"vb.funcbody":{"text":"printMsg \"[*] Checking Application.Tasks.Name ...\"\n\n    badTask = False\n    badTaskNames = Array(\"vbox\", \"vmware\", \"vxstream\", \"autoit\", \"vmtools\", \"tcpview\", \"wireshark\", \"process explorer\", \"visual basic\", \"fiddler\")\n    \n    For Each Task In Application.Tasks\n    \n        For Each badTaskName In badTaskNames\n            If InStr(LCase(Task.Name), badTaskName) > 0 Then\n                badTask = True\n            End If\n        Next\n        \n    Next\n\n    If badTask Then\n        \n        printMsg \"DETECTED\"\n    Else\n        \n        printMsg \"OK\"\n    End If\n    \n","pos":1826}}],"text":"Sub checkTasks()\n\n    printMsg \"[*] Checking Application.Tasks.Name ...\"\n\n    badTask = False\n    badTaskNames = Array(\"vbox\", \"vmware\", \"vxstream\", \"autoit\", \"vmtools\", \"tcpview\", \"wireshark\", \"process explorer\", \"visual basic\", \"fiddler\")\n    \n    For Each Task In Application.Tasks\n    \n        For Each badTaskName In badTaskNames\n            If InStr(LCase(Task.Name), badTaskName) > 0 Then\n                badTask = True\n            End If\n        Next\n        \n    Next\n\n    If badTask Then\n        \n        printMsg \"DETECTED\"\n    Else\n        \n        printMsg \"OK\"\n    End If\n    \nEnd Sub","pos":1804}},{"vb.function":{"subs":[{"vb.funcdef":{"subs":[{"vb.funcname":{"text":"checkCores","pos":2415}}],"text":"Sub checkCores()\n\n    ","pos":2411}},{"vb.funcbody":{"text":"printMsg \"[*] Checking Win32_Processor.NumberOfCores ...\"\n\n    badCores = 0\n\n    Set objWMIService = GetObject(\"winmgmts:\\\\.\\root\\cimv2\")\n    Set colItems = objWMIService.ExecQuery(\"Select * from Win32_Processor\", , 48)\n    \n    For Each objItem In colItems\n    \n            If objItem.NumberOfCores < 2 Then\n                badCores = True\n            End If\n        \n    Next\n\n    If badCores Then\n        \n        printMsg \"DETECTED\"\n    Else\n        \n        printMsg \"OK\"\n    End If\n    \n","pos":2433}}],"text":"Sub checkCores()\n\n    printMsg \"[*] Checking Win32_Processor.NumberOfCores ...\"\n\n    badCores = 0\n\n    Set objWMIService = GetObject(\"winmgmts:\\\\.\\root\\cimv2\")\n    Set colItems = objWMIService.ExecQuery(\"Select * from Win32_Processor\", , 48)\n    \n    For Each objItem In colItems\n    \n            If objItem.NumberOfCores < 2 Then\n                badCores = True\n            End If\n        \n    Next\n\n    If badCores Then\n        \n        printMsg \"DETECTED\"\n    Else\n        \n        printMsg \"OK\"\n    End If\n    \nEnd Sub","pos":2411}},{"vb.function":{"subs":[{"vb.funcdef":{"subs":[{"vb.funcname":{"text":"checkBios","pos":2946}}],"text":"Sub checkBios()\n\n    ","pos":2942}},{"vb.funcbody":{"text":"printMsg \"[*] Checking Win32_Bios.SMBIOSBIOSVersion & SerialNumber ...\"\n\n    badBios = False\n    badBiosNames = Array(\"virtualbox\", \"vmware\", \"kvm\")\n    \n    Set objWMIService = GetObject(\"winmgmts:\\\\.\\root\\cimv2\")\n    Set colItems = objWMIService.ExecQuery(\"Select * from Win32_Bios\", , 48)\n    \n    For Each objItem In colItems\n    \n        For Each badName In badBiosNames\n            If InStr(LCase(objItem.SMBIOSBIOSVersion), badName) > 0 Then\n                badBios = True\n            End If\n            If InStr(LCase(objItem.SerialNumber), badName) > 0 Then\n                badBios = True\n            End If\n        Next\n        \n    Next\n\n    If badBios Then\n        \n        printMsg \"DETECTED\"\n    Else\n        \n        printMsg \"OK\"\n    End If\n    \n","pos":2963}}],"text":"Sub checkBios()\n\n    printMsg \"[*] Checking Win32_Bios.SMBIOSBIOSVersion & SerialNumber ...\"\n\n    badBios = False\n    badBiosNames = Array(\"virtualbox\", \"vmware\", \"kvm\")\n    \n    Set objWMIService = GetObject(\"winmgmts:\\\\.\\root\\cimv2\")\n    Set colItems = objWMIService.ExecQuery(\"Select * from Win32_Bios\", , 48)\n    \n    For Each objItem In colItems\n    \n        For Each badName In badBiosNames\n            If InStr(LCase(objItem.SMBIOSBIOSVersion), badName) > 0 Then\n                badBios = True\n            End If\n            If InStr(LCase(objItem.SerialNumber), badName) > 0 Then\n                badBios = True\n            End If\n        Next\n        \n    Next\n\n    If badBios Then\n        \n        printMsg \"DETECTED\"\n    Else\n        \n        printMsg \"OK\"\n    End If\n    \nEnd Sub","pos":2942}},{"vb.function":{"subs":[{"vb.funcdef":{"subs":[{"vb.funcname":{"text":"checkPnP","pos":3745}}],"text":"Sub checkPnP()\n\n    ","pos":3741}},{"vb.funcbody":{"text":"printMsg \"[*] Checking Win32_PnPEntity.DeviceId ...\"\n\n    badPNP = False\n    badPNPNames = Array(\"VEN_80EE\", \"VEN_15AD\")\n    \n    Set objWMIService = GetObject(\"winmgmts:\\\\.\\root\\cimv2\")\n    Set colItems = objWMIService.ExecQuery(\"Select * from Win32_PnPEntity\", , 48)\n    \n    For Each objItem In colItems\n    \n        For Each badName In badPNPNames\n            If InStr(LCase(objItem.DeviceId), badName) > 0 Then\n                badPNP = True\n            End If\n        Next\n        \n    Next\n\n    If badPNP Then\n        \n        printMsg \"DETECTED\"\n    Else\n        \n        printMsg \"OK\"\n    End If\n    \n","pos":3761}}],"text":"Sub checkPnP()\n\n    printMsg \"[*] Checking Win32_PnPEntity.DeviceId ...\"\n\n    badPNP = False\n    badPNPNames = Array(\"VEN_80EE\", \"VEN_15AD\")\n    \n    Set objWMIService = GetObject(\"winmgmts:\\\\.\\root\\cimv2\")\n    Set colItems = objWMIService.ExecQuery(\"Select * from Win32_PnPEntity\", , 48)\n    \n    For Each objItem In colItems\n    \n        For Each badName In badPNPNames\n            If InStr(LCase(objItem.DeviceId), badName) > 0 Then\n                badPNP = True\n            End If\n        Next\n        \n    Next\n\n    If badPNP Then\n        \n        printMsg \"DETECTED\"\n    Else\n        \n        printMsg \"OK\"\n    End If\n    \nEnd Sub","pos":3741}},{"vb.function":{"subs":[{"vb.funcdef":{"subs":[{"vb.funcname":{"text":"checkUsername","pos":4390}}],"text":"Sub checkUsername()\n\n    ","pos":4386}},{"vb.funcbody":{"text":"printMsg \"[*] Checking Win32_ComputerSystem.Username ...\"\n\n    badUsername = False\n    badUsernames = Array(\"admin\", \"malfind\", \"sandbox\", \"test\")\n    \n    Set objWMIService = GetObject(\"winmgmts:\\\\.\\root\\cimv2\")\n    Set colItems = objWMIService.ExecQuery(\"Select * from Win32_ComputerSystem\", , 48)\n    \n    For Each objItem In colItems\n    \n        For Each badName In badUsernames\n            If InStr(LCase(objItem.UserName), badName) > 0 Then\n                badUsername = True\n            End If\n        Next\n        \n    Next\n\n    If badUsername Then\n        \n        printMsg \"DETECTED\"\n    Else\n        \n        printMsg \"OK\"\n    End If\n    \n","pos":4411}}],"text":"Sub checkUsername()\n\n    printMsg \"[*] Checking Win32_ComputerSystem.Username ...\"\n\n    badUsername = False\n    badUsernames = Array(\"admin\", \"malfind\", \"sandbox\", \"test\")\n    \n    Set objWMIService = GetObject(\"winmgmts:\\\\.\\root\\cimv2\")\n    Set colItems = objWMIService.ExecQuery(\"Select * from Win32_ComputerSystem\", , 48)\n    \n    For Each objItem In colItems\n    \n        For Each badName In badUsernames\n            If InStr(LCase(objItem.UserName), badName) > 0 Then\n                badUsername = True\n            End If\n        Next\n        \n    Next\n\n    If badUsername Then\n        \n        printMsg \"DETECTED\"\n    Else\n        \n        printMsg \"OK\"\n    End If\n    \nEnd Sub","pos":4386}},{"vb.function":{"subs":[{"vb.funcdef":{"subs":[{"vb.funcname":{"text":"checkPartOfDomain","pos":5082}}],"text":"Sub checkPartOfDomain()\n\n    ","pos":5078}},{"vb.funcbody":{"text":"printMsg \"[*] Checking Win32_ComputerSystem.PartOfDomain ...\"\n\n    partOfDomain = False\n    Set objWMIService = GetObject(\"winmgmts:\\\\.\\root\\cimv2\")\n    Set colItems = objWMIService.ExecQuery(\"Select * from Win32_ComputerSystem\", , 48)\n    \n    For Each objItem In colItems\n        If objItem.partOfDomain Then\n            partOfDomain = True\n        End If\n    Next\n\n    If partOfDomain Then\n        printMsg \"OK\"\n        \n    Else\n        printMsg \"DETECTED\"\n    End If\n    \n","pos":5107}}],"text":"Sub checkPartOfDomain()\n\n    printMsg \"[*] Checking Win32_ComputerSystem.PartOfDomain ...\"\n\n    partOfDomain = False\n    Set objWMIService = GetObject(\"winmgmts:\\\\.\\root\\cimv2\")\n    Set colItems = objWMIService.ExecQuery(\"Select * from Win32_ComputerSystem\", , 48)\n    \n    For Each objItem In colItems\n        If objItem.partOfDomain Then\n            partOfDomain = True\n        End If\n    Next\n\n    If partOfDomain Then\n        printMsg \"OK\"\n        \n    Else\n        printMsg \"DETECTED\"\n    End If\n    \nEnd Sub","pos":5078}},{"vb.function":{"subs":[{"vb.funcdef":{"subs":[{"vb.funcname":{"text":"checkZoneIdentifier","pos":5604}}],"text":"Sub checkZoneIdentifier()\n\n    ","pos":5600}},{"vb.funcbody":{"text":"printMsg \"[*] Checking Zone.Identifier ...\"\n\n    If CreateObject(\"Scripting.FileSystemObject\").FileExists(ThisDocument.Path & Application.PathSeparator & ThisDocument.Name & \":Zone.Identifier\") Then\n    \n        printMsg \"OK\"\n        \n    Else\n    \n        printMsg \"DETECTED\"\n    End If\n    \n","pos":5631}}],"text":"Sub checkZoneIdentifier()\n\n    printMsg \"[*] Checking Zone.Identifier ...\"\n\n    If CreateObject(\"Scripting.FileSystemObject\").FileExists(ThisDocument.Path & Application.PathSeparator & ThisDocument.Name & \":Zone.Identifier\") Then\n    \n        printMsg \"OK\"\n        \n    Else\n    \n        printMsg \"DETECTED\"\n    End If\n    \nEnd Sub","pos":5600}},{"vb.function":{"subs":[{"vb.funcdef":{"subs":[{"vb.funcname":{"text":"checkNbrOfTask","pos":5944}}],"text":"Sub checkNbrOfTask()\n\n    ","pos":5940}},{"vb.funcbody":{"text":"printMsg \"[*] Checking Application.Tasks.Count ...\"\n\n    If Application.Tasks.Count < 3 Then\n    \n        printMsg \"DETECTED\"\n        \n    Else\n    \n        printMsg \"OK\"\n    End If\n    \n","pos":5966}}],"text":"Sub checkNbrOfTask()\n\n    printMsg \"[*] Checking Application.Tasks.Count ...\"\n\n    If Application.Tasks.Count < 3 Then\n    \n        printMsg \"DETECTED\"\n        \n    Else\n    \n        printMsg \"OK\"\n    End If\n    \nEnd Sub","pos":5940}},{"vb.function":{"subs":[{"vb.funcdef":{"subs":[{"vb.funcname":{"text":"checkRecentDocs","pos":6173}}],"text":"Sub checkRecentDocs()\n\n    ","pos":6169}},{"vb.funcbody":{"text":"printMsg \"[*] Checking Application.RecentFiles.Count ...\"\n\n    If Application.RecentFiles.Count < 3 Then\n    \n        printMsg \"DETECTED\"\n        \n    Else\n    \n        printMsg \"OK\"\n    End If\n    \n","pos":6196}}],"text":"Sub checkRecentDocs()\n\n    printMsg \"[*] Checking Application.RecentFiles.Count ...\"\n\n    If Application.RecentFiles.Count < 3 Then\n    \n        printMsg \"DETECTED\"\n        \n    Else\n    \n        printMsg \"OK\"\n    End If\n    \nEnd Sub","pos":6169}},{"vb.function":{"subs":[{"vb.funcdef":{"subs":[{"vb.funcname":{"text":"mark","pos":6743}}],"text":"Sub mark()\n\n  ","pos":6739}},{"vb.funcbody":{"text":"Text = ActiveDocument.Range.Text\n \n    toks = Split(Text, vbCr)\n    \n    c = 0\n    \n    For Each tok In toks\n        \n        l = Len(tok)\n        \n        If tok = \"OK\" Then\n\n            ActiveDocument.Range(c, c + l).Font.color = vbGreen\n     \n        End If\n  \n        If tok = \"DETECTED\" Then\n\n            ActiveDocument.Range(c, c + l).Font.color = vbRed\n     \n        End If\n        \n        \n        c = c + l + 1\n    Next\n    \n    ActiveDocument.Range.ParagraphFormat.SpaceBefore = 0\n    ActiveDocument.Range.ParagraphFormat.SpaceAfter = 0\n    ActiveDocument.Range.Font.Size = 8\n  \n","pos":6753}}],"text":"Sub mark()\n\n  Text = ActiveDocument.Range.Text\n \n    toks = Split(Text, vbCr)\n    \n    c = 0\n    \n    For Each tok In toks\n        \n        l = Len(tok)\n        \n        If tok = \"OK\" Then\n\n            ActiveDocument.Range(c, c + l).Font.color = vbGreen\n     \n        End If\n  \n        If tok = \"DETECTED\" Then\n\n            ActiveDocument.Range(c, c + l).Font.color = vbRed\n     \n        End If\n        \n        \n        c = c + l + 1\n    Next\n    \n    ActiveDocument.Range.ParagraphFormat.SpaceBefore = 0\n    ActiveDocument.Range.ParagraphFormat.SpaceAfter = 0\n    ActiveDocument.Range.Font.Size = 8\n  \nEnd Sub","pos":6739}}],"text":"Private Sub Document_Open()\n\n   On Error Resume Next\n\n   ActiveDocument.Range.Text = \"Pafish for Office Macro v2, by Joe Security\" & vbCrLf & vbCrLf & \"Includes latest in-the-wild evasion checks. Developed to test and improve sandboxes!\" & vbCrLf\n   \n   checkRecentDocs\n   \n   checkNbrOfTask\n   \n   checkTasks\n   \n   checkZoneIdentifier\n   \n   checkPartOfDomain\n   \n   checkBios\n   \n   checkPnP\n   \n   checkUsername\n   \n   checkFilenameHash\n   \n   checkFilenameBad\n   \n   checkPreciseFileName\n   \n   checkCores\n   \n   mark\n   \nEnd Sub\n\nPublic Sub checkPreciseFileName()\n\n    printMsg \"[*] Checking Precise Filename ...\"\n    \n    badName = False\n\n  \n    If ActiveDocument.Name <> \"Pafish.docm\" Then\n            badName = True\n    End If\n \n    If badName Then\n        \n        printMsg \"DETECTED\"\n    Else\n        \n        printMsg \"OK\"\n    End If\n    \nEnd Sub\n\nPublic Sub checkFilenameHash()\n\n    printMsg \"[*] Checking Filename Hashname ...\"\n    \n    hexchars = \"0123456789abcdef\"\n    \n    c = 0\n    \n    For i = 1 To Len(ThisDocument.Name)\n        s = Mid(LCase(ThisDocument.Name), i, 1)\n        \n        If InStr(s, hexchars) > 0 Then\n            c = c + 1\n        End If\n        \n    Next\n    \n    If c >= (Len(ThisDocument.Name) - 5) Then\n        printMsg \"DETECTED\"\n        \n    Else\n    \n    \n        printMsg \"OK\"\n    End If\n    \nEnd Sub\n\nPublic Sub checkFilenameBad()\n\n    printMsg \"[*] Checking Bad Filename ...\"\n    \n    badName = False\n    badNames = Array(\"malware\", \"myapp\", \"sample\", \".bin\", \"mlwr_\", \"Desktop\")\n\n    \n    For Each n In badNames\n        If InStr(LCase(ActiveDocument.FullName), n) > 0 Then\n            badName = True\n        End If\n    Next\n \n\n    If badName Then\n        \n        printMsg \"DETECTED\"\n    Else\n        \n        printMsg \"OK\"\n    End If\n    \nEnd Sub\n\nPublic Sub checkTasks()\n\n    printMsg \"[*] Checking Application.Tasks.Name ...\"\n\n    badTask = False\n    badTaskNames = Array(\"vbox\", \"vmware\", \"vxstream\", \"autoit\", \"vmtools\", \"tcpview\", \"wireshark\", \"process explorer\", \"visual basic\", \"fiddler\")\n    \n    For Each Task In Application.Tasks\n    \n        For Each badTaskName In badTaskNames\n            If InStr(LCase(Task.Name), badTaskName) > 0 Then\n                badTask = True\n            End If\n        Next\n        \n    Next\n\n    If badTask Then\n        \n        printMsg \"DETECTED\"\n    Else\n        \n        printMsg \"OK\"\n    End If\n    \nEnd Sub\n\nPublic Sub checkCores()\n\n    printMsg \"[*] Checking Win32_Processor.NumberOfCores ...\"\n\n    badCores = 0\n\n    Set objWMIService = GetObject(\"winmgmts:\\\\.\\root\\cimv2\")\n    Set colItems = objWMIService.ExecQuery(\"Select * from Win32_Processor\", , 48)\n    \n    For Each objItem In colItems\n    \n            If objItem.NumberOfCores < 2 Then\n                badCores = True\n            End If\n        \n    Next\n\n    If badCores Then\n        \n        printMsg \"DETECTED\"\n    Else\n        \n        printMsg \"OK\"\n    End If\n    \nEnd Sub\n\nPublic Sub checkBios()\n\n    printMsg \"[*] Checking Win32_Bios.SMBIOSBIOSVersion & SerialNumber ...\"\n\n    badBios = False\n    badBiosNames = Array(\"virtualbox\", \"vmware\", \"kvm\")\n    \n    Set objWMIService = GetObject(\"winmgmts:\\\\.\\root\\cimv2\")\n    Set colItems = objWMIService.ExecQuery(\"Select * from Win32_Bios\", , 48)\n    \n    For Each objItem In colItems\n    \n        For Each badName In badBiosNames\n            If InStr(LCase(objItem.SMBIOSBIOSVersion), badName) > 0 Then\n                badBios = True\n            End If\n            If InStr(LCase(objItem.SerialNumber), badName) > 0 Then\n                badBios = True\n            End If\n        Next\n        \n    Next\n\n    If badBios Then\n        \n        printMsg \"DETECTED\"\n    Else\n        \n        printMsg \"OK\"\n    End If\n    \nEnd Sub\n\nPublic Sub checkPnP()\n\n    printMsg \"[*] Checking Win32_PnPEntity.DeviceId ...\"\n\n    badPNP = False\n    badPNPNames = Array(\"VEN_80EE\", \"VEN_15AD\")\n    \n    Set objWMIService = GetObject(\"winmgmts:\\\\.\\root\\cimv2\")\n    Set colItems = objWMIService.ExecQuery(\"Select * from Win32_PnPEntity\", , 48)\n    \n    For Each objItem In colItems\n    \n        For Each badName In badPNPNames\n            If InStr(LCase(objItem.DeviceId), badName) > 0 Then\n                badPNP = True\n            End If\n        Next\n        \n    Next\n\n    If badPNP Then\n        \n        printMsg \"DETECTED\"\n    Else\n        \n        printMsg \"OK\"\n    End If\n    \nEnd Sub\n\nPublic Sub checkUsername()\n\n    printMsg \"[*] Checking Win32_ComputerSystem.Username ...\"\n\n    badUsername = False\n    badUsernames = Array(\"admin\", \"malfind\", \"sandbox\", \"test\")\n    \n    Set objWMIService = GetObject(\"winmgmts:\\\\.\\root\\cimv2\")\n    Set colItems = objWMIService.ExecQuery(\"Select * from Win32_ComputerSystem\", , 48)\n    \n    For Each objItem In colItems\n    \n        For Each badName In badUsernames\n            If InStr(LCase(objItem.UserName), badName) > 0 Then\n                badUsername = True\n            End If\n        Next\n        \n    Next\n\n    If badUsername Then\n        \n        printMsg \"DETECTED\"\n    Else\n        \n        printMsg \"OK\"\n    End If\n    \nEnd Sub\n\nPublic Sub checkPartOfDomain()\n\n    printMsg \"[*] Checking Win32_ComputerSystem.PartOfDomain ...\"\n\n    partOfDomain = False\n    Set objWMIService = GetObject(\"winmgmts:\\\\.\\root\\cimv2\")\n    Set colItems = objWMIService.ExecQuery(\"Select * from Win32_ComputerSystem\", , 48)\n    \n    For Each objItem In colItems\n        If objItem.partOfDomain Then\n            partOfDomain = True\n        End If\n    Next\n\n    If partOfDomain Then\n        printMsg \"OK\"\n        \n    Else\n        printMsg \"DETECTED\"\n    End If\n    \nEnd Sub\n\nPublic Sub checkZoneIdentifier()\n\n    printMsg \"[*] Checking Zone.Identifier ...\"\n\n    If CreateObject(\"Scripting.FileSystemObject\").FileExists(ThisDocument.Path & Application.PathSeparator & ThisDocument.Name & \":Zone.Identifier\") Then\n    \n        printMsg \"OK\"\n        \n    Else\n    \n        printMsg \"DETECTED\"\n    End If\n    \nEnd Sub\n\nPublic Sub checkNbrOfTask()\n\n    printMsg \"[*] Checking Application.Tasks.Count ...\"\n\n    If Application.Tasks.Count < 3 Then\n    \n        printMsg \"DETECTED\"\n        \n    Else\n    \n        printMsg \"OK\"\n    End If\n    \nEnd Sub\n\nPublic Sub checkRecentDocs()\n\n    printMsg \"[*] Checking Application.RecentFiles.Count ...\"\n\n    If Application.RecentFiles.Count < 3 Then\n    \n        printMsg \"DETECTED\"\n        \n    Else\n    \n        printMsg \"OK\"\n    End If\n    \nEnd Sub\n\nPublic Function printMsg(msg)\n\n   ActiveDocument.Range.Text = ActiveDocument.Range.Text & msg\n   \n   Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n \n    outFile = \"pafish.log\"\n    Set objFile = objFSO.CreateTextFile(outFile, True)\n    objFile.Write ActiveDocument.Range.Text & msg\n    objFile.Close\n    \nEnd Function\n\nPublic Sub mark()\n\n  Text = ActiveDocument.Range.Text\n \n    toks = Split(Text, vbCr)\n    \n    c = 0\n    \n    For Each tok In toks\n        \n        l = Len(tok)\n        \n        If tok = \"OK\" Then\n\n            ActiveDocument.Range(c, c + l).Font.color = vbGreen\n     \n        End If\n  \n        If tok = \"DETECTED\" Then\n\n            ActiveDocument.Range(c, c + l).Font.color = vbRed\n     \n        End If\n        \n        \n        c = c + l + 1\n    Next\n    \n    ActiveDocument.Range.ParagraphFormat.SpaceBefore = 0\n    ActiveDocument.Range.ParagraphFormat.SpaceAfter = 0\n    ActiveDocument.Range.Font.Size = 8\n  \nEnd Sub\n","pos":1}}
