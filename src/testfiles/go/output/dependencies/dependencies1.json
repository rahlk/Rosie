{"go.dependencies":{"pos":1,"text":"package main\n\nimport (\n\t\"io\/ioutil\"\n\t\"net\/http\"\n\t\"os\"\n\t\"os\/exec\"\n\t\"text\/template\"\n\n\t\"github.com\/gorilla\/mux\"\n\t\"github.com\/microcosm-cc\/bluemonday\"\n\t\"github.com\/russross\/blackfriday\"\n)\n\n\/\/ memory usage optimizations\nconst (\n\temtyStr  = \"\"\n\tgit      = \"git\"\n\tcheckout = \"checkout\"\n\tforce    = \"-f\"\n\tpull     = \"pull\"\n\n\t\/\/ options\n\treadmePath = \".\/README.md\"\n\ttplPath    = \"tmpl\/tmpl.html\"\n\tidxPath    = \"tmpl\/index.html\"\n\n\tbfHTMLRendererOpts = 0 |\n\t\tblackfriday.HTML_USE_XHTML |\n\t\tblackfriday.HTML_USE_SMARTYPANTS |\n\t\tblackfriday.HTML_SMARTYPANTS_FRACTIONS |\n\t\tblackfriday.HTML_SMARTYPANTS_DASHES |\n\t\tblackfriday.HTML_SMARTYPANTS_LATEX_DASHES\n\n\tbfMDOpts = 0 |\n\t\tblackfriday.EXTENSION_NO_INTRA_EMPHASIS |\n\t\tblackfriday.EXTENSION_TABLES |\n\t\tblackfriday.EXTENSION_FENCED_CODE |\n\t\tblackfriday.EXTENSION_AUTOLINK |\n\t\tblackfriday.EXTENSION_STRIKETHROUGH |\n\t\tblackfriday.EXTENSION_SPACE_HEADERS |\n\t\tblackfriday.EXTENSION_HEADER_IDS |\n\t\tblackfriday.EXTENSION_BACKSLASH_LINE_BREAK |\n\t\tblackfriday.EXTENSION_DEFINITION_LISTS |\n\t\tblackfriday.EXTENSION_AUTO_HEADER_IDS\n)\n\nvar (\n\tdoneResp = []byte(\"Done!\\n\")\n)\n\ntype content struct {\n\tBody string\n}\n\nfunc generateHTML() {\n\t\/\/ Update repo\n\texec.Command(git, checkout, force).Output()\n\texec.Command(git, pull).Output()\n\n\tinput, _ := ioutil.ReadFile(readmePath)\n\tbody := string(\n\t\tbluemonday.UGCPolicy().SanitizeBytes(\n\t\t\tblackfriday.Markdown(\n\t\t\t\tinput,\n\t\t\t\tblackfriday.HtmlRenderer(\n\t\t\t\t\tbfHTMLRendererOpts,\n\t\t\t\t\temtyStr,\n\t\t\t\t\temtyStr,\n\t\t\t\t),\n\t\t\t\tbfMDOpts,\n\t\t\t),\n\t\t),\n\t)\n\tc := &content{Body: body}\n\n\tt := template.Must(template.ParseFiles(tplPath))\n\tf, _ := os.Create(idxPath)\n\tt.Execute(f, c)\n}\n\nfunc hookHandler(w http.ResponseWriter, r *http.Request) {\n\tgo generateHTML()\n\tw.Write(doneResp)\n}\n\nfunc main() {\n\tr := mux.NewRouter()\n\tr.HandleFunc(\"\/hook\", hookHandler)\n\thttp.ListenAndServe(\":9000\", r)\n}\n","subs":[{"go.package":{"pos":1,"text":"package main","subs":[{"go.package_text":{"pos":9,"text":"main"}}]}},{"go.dependencies_factor":{"pos":15,"text":"import (\n\t\"io\/ioutil\"\n\t\"net\/http\"\n\t\"os\"\n\t\"os\/exec\"\n\t\"text\/template\"\n\n\t\"github.com\/gorilla\/mux\"\n\t\"github.com\/microcosm-cc\/bluemonday\"\n\t\"github.com\/russross\/blackfriday\"\n)","subs":[{"go.import_list":{"pos":24,"text":"\t\"io\/ioutil\"\n\t\"net\/http\"\n\t\"os\"\n\t\"os\/exec\"\n\t\"text\/template\"\n\n\t\"github.com\/gorilla\/mux\"\n\t\"github.com\/microcosm-cc\/bluemonday\"\n\t\"github.com\/russross\/blackfriday\"\n)","subs":[{"go.dependencies_text":{"pos":26,"text":"io\/ioutil"}},{"go.dependencies_text":{"pos":39,"text":"net\/http"}},{"go.dependencies_text":{"pos":51,"text":"os"}},{"go.dependencies_text":{"pos":57,"text":"os\/exec"}},{"go.dependencies_text":{"pos":68,"text":"text\/template"}},{"go.dependencies_text":{"pos":86,"text":"github.com\/gorilla\/mux"}},{"go.dependencies_text":{"pos":112,"text":"github.com\/microcosm-cc\/bluemonday"}},{"go.dependencies_text":{"pos":150,"text":"github.com\/russross\/blackfriday"}}]}}]}}]}}
